<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Prepare a Blazor project </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Prepare a Blazor project ">
    <meta name="generator" content="docfx 2.51.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="prepare-a-blazor-project">Prepare a Blazor project</h1>

<p>We start the preparations by generating a new Blazor Webassembly project from Visual Studio.
Make sure you have the WebAssembly templates installed by following the <a href="https://docs.microsoft.com/en-us/aspnet/core/blazor/get-started?view=aspnetcore-3.1&amp;tabs=visual-studio">instructions in the
documentation</a>.</p>
<blockquote>
<p>We will use a WebAssembly project for these preparations, but the steps for Server Side
Blazor are roughly the same.</p>
</blockquote>
<p>Create a new project using the settings below:</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_createpage-1" role="tab" aria-controls="tabpanel_CeZOj-G++Q_createpage-1" data-tab="createpage-1" tabindex="0" aria-selected="true">Create Page 1</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_createpage-2" role="tab" aria-controls="tabpanel_CeZOj-G++Q_createpage-2" data-tab="createpage-2" tabindex="-1">Create Page 2</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_createpage-3" role="tab" aria-controls="tabpanel_CeZOj-G++Q_createpage-3" data-tab="createpage-3" tabindex="-1">Create Page 3</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_createpage-1" role="tabpanel" data-tab="createpage-1">

<p><img src="../images/newproject1.png" alt="New project, page 1"></p>
</section>
<section id="tabpanel_CeZOj-G++Q_createpage-2" role="tabpanel" data-tab="createpage-2" aria-hidden="true" hidden="hidden">

<p><img src="../images/newproject2.png" alt="New project, page 2"></p>
</section>
<section id="tabpanel_CeZOj-G++Q_createpage-3" role="tabpanel" data-tab="createpage-3" aria-hidden="true" hidden="hidden">

<p><img src="../images/newproject3.png" alt="New project, page 3"></p>
</section>
</div>
<h2 id="add-a-shared-rcl-project">Add a shared RCL project</h2>
<p>To prepare a Blazor project for use with a BlazorWebView it is best to move all dynamic
Blazor content to a Razor Class Library, and keep only the static content inside the
WebAssembly project. We do this by adding a new project to the solution first:</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_addpage-1" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_addpage-1" data-tab="addpage-1" tabindex="0" aria-selected="true">Add Project 1</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_addpage-2" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_addpage-2" data-tab="addpage-2" tabindex="-1">Add Project 2</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_addpage-3" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_addpage-3" data-tab="addpage-3" tabindex="-1">Add Project 3</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q-1_addpage-1" role="tabpanel" data-tab="addpage-1">

<p><img src="../images/addnewproject1.png" alt="Add New project, page 1"></p>
</section>
<section id="tabpanel_CeZOj-G++Q-1_addpage-2" role="tabpanel" data-tab="addpage-2" aria-hidden="true" hidden="hidden">

<p><img src="../images/addnewproject2.png" alt="Add New project, page 2"></p>
</section>
<section id="tabpanel_CeZOj-G++Q-1_addpage-3" role="tabpanel" data-tab="addpage-3" aria-hidden="true" hidden="hidden">

<p><img src="../images/addnewproject3.png" alt="Add New project, page 3"></p>
</section>
</div>

<p>We can delete all content that has been generated as an example in the RCL project,
as we will move over the content from the WebAssembly project shortly. Don't delete
the wwwroot folder itself, we will use that later on.</p>
<p>Finally add a reference from the WebAssembly project to the shared project:</p>
<ul>
<li>Right click <code>Dependencies</code> node in the solution explorer of the WebAssembly project.</li>
<li>Select <code>Add reference...</code></li>
<li>In the dialog that is opened, click <code>Projects</code> and <code>Solution</code>.</li>
<li>Select your shared RCL project.</li>
</ul>
<h2 id="moving-over-the-neccesary-files-and-folders">Moving over the neccesary files and folders.</h2>
<p>Now move over the following items from the WebAssembly project to the shared project,
leaving only the favicon.ico and index.html files in the wwwroot behind:</p>
<ul>
<li>Pages</li>
<li>Shared</li>
<li>_Imports.razor</li>
<li>App.razor</li>
<li>wwwroot/css</li>
<li>wwwroot/sample-data</li>
</ul>
<p>You'll arrive at the following structure:</p>
<p><img src="../images/finalstructure.png" alt="Final structure"></p>
<h2 id="clean-up-the-build-errors">Clean up the build errors.</h2>
<p>Now build your solution. You'll get a list of build errors that need to be adressed:</p>
<p><img src="../images/builderrors.png" alt="build errors"></p>
<p>We will fix these one by one:</p>
<ul>
<li>First we change the namespaces in _Imports.Razor to match the shared library instead of
the WebAssembly project:</li>
</ul>
<pre><code class="lang-cshtml-razor">@using System.Net.Http
@using Microsoft.AspNetCore.Components.Forms
@using Microsoft.AspNetCore.Components.Routing
@using Microsoft.AspNetCore.Components.Web
@using Microsoft.JSInterop
&lt;!-- change these last two lines to match the namespaces of your shared library !--&gt;
@using BlazorWebView.Tutorial
@using BlazorWebView.Tutorial.Shared
</code></pre>
<ul>
<li>Next add a nuget reference to <code>Microsoft.AspNetCore.Blazor.HttpClient</code> to the shared project
as well (It is already in the webassembly project).</li>
<li>Finally we add a using statement to the Program.cs folder in the webassembly project to
resolve the App class at a new location:</li>
</ul>
<pre><code class="lang-csharp">using System;
using System.Collections.Generic;
using System.Threading.Tasks;
using System.Text;
using Microsoft.AspNetCore.Components.WebAssembly.Hosting;
using Microsoft.Extensions.DependencyInjection;
// Add this line and have it match the location of the App class.
using BlazorWebView.Shared;

namespace BlazorWebView.Tutorial
{
    public class Program
    {
        public static async Task Main(string[] args)
        {
            var builder = WebAssemblyHostBuilder.CreateDefault(args);
            builder.RootComponents.Add&lt;App&gt;(&quot;app&quot;);

            builder.Services.AddBaseAddressHttpClient();

            await builder.Build().RunAsync();
        }
    }
}
</code></pre>
<p>The project should now build without any errors. Let's move on and try to run it:</p>
<h2 id="solving-some-runtime-problems">Solving some runtime problems</h2>
<p>Click Debug or press F5 to build and run the project. A browser page will open that looks like this:</p>
<p><img src="../images/browsererror.png" alt="browser error"></p>
<p>This is because the files we have moved from the webassembly wwwroot folder to the shared project
wwwroot folder are not copied to the output directory. This is why blazor webassembly cannot find
them. The easiest way to solve this, is by editing the shared .csproj file directly. You can do
this by right-clicking the file in the solution explorer and choosing &quot;Edit project file&quot; from
the context menu.
Next add the following content inside the <code>&lt;project&gt;</code> tag to change the copy behaviour for all
content inside the wwwroot folder:</p>
<pre><code class="lang-xml">  &lt;ItemGroup&gt;
    &lt;Content Update=&quot;wwwroot\**\*&quot;&gt;
      &lt;CopyToOutputDirectory&gt;PreserveNewest&lt;/CopyToOutputDirectory&gt;
    &lt;/Content&gt;
  &lt;/ItemGroup&gt;
</code></pre>
<p>Press F5 again. The project should now build, run and the sample should be in working order.
Congratulations! You've completed the preparations and are ready to move on to one of the
tutorials. The source code so far is in this branch:</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/jspuij/BlazorWebView/blob/master/docs/pages/prepare.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
